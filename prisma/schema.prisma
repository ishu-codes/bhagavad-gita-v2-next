generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Chapter {
  id           String    @id @default(cuid())
  code         String    @db.VarChar(5)
  name         String    @unique @db.VarChar(255)
  desc         String
  verses_count Int       @db.SmallInt
  lang         String    @db.VarChar(3)
  sections     Section[]

  @@unique([code, lang])
  @@map("chapters")
}

model Section {
  id       String  @id @default(cuid())
  code     String  @db.VarChar(5)
  title    String
  chapCode String
  chapLang String
  groups   Group[]
  chapters Chapter @relation(fields: [chapCode, chapLang], references: [code, lang], onDelete: Cascade, onUpdate: Restrict)

  @@unique([code, chapLang])
  @@map("sections")
}

model Group {
  id          String  @id @default(cuid())
  code        String  @db.VarChar(25)
  translation String
  meanings    Json
  secCode     String
  secLang     String
  sections    Section @relation(fields: [secCode, secLang], references: [code, chapLang], onDelete: Cascade, onUpdate: Restrict)
  // phrases     Phrase[]

  @@unique([code, secLang])
  @@index([meanings], map: "meanings")
  @@map("groups")
}

model Phrase {
  id        String @id @default(cuid())
  code      String @db.VarChar(7)
  num       String @db.VarChar(5)
  title     String @db.VarChar(255)
  groupCode String @db.VarChar(25)
  script    String @db.VarChar(3)

  @@unique([code, script])
  @@index([title], map: "subverse")
  @@map("phrases")
}
